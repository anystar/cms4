<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Web Works CMS</title>

    <!-- Bootstrap -->
    <link href="{{ @BASE }}/admin/bootstrap.min.css" rel="stylesheet">
    <link href="{{ @BASE }}/admin/theme" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <style>
      h2 {
         margin-bottom: 30px;
      }

      h3 {
        margin-top: 10px;
      }

      .page {
        margin: 0 0 30px 0;
        padding: 10px;
        border: 1px solid #cce;
        -webkit-border-radius: 10px;
        -moz-border-radius: 10px;
        border-radius: 10px;
        -webkit-box-shadow: 2px 2px 1px 1px rgba(179,179,179,1);
        -moz-box-shadow: 2px 2px 1px 1px rgba(179,179,179,1);
        box-shadow: 2px 2px 1px 1px rgba(179,179,179,1);
      }

      .addcontent {
        position: relative;
        top: 3px;
        color: blue;
      }

      .glyphicon-plus {
        cursor:pointer;
      }
    </style>
  </head>
  <body>
    <h1><img src="{{@BASE}}/admin/imgs/logo.png" alt="Web Works CMS Login"></h1>

    <div class="nav top_nav">
      <include href="/admin/navigation.html" />
    </div>

    <div class="container">
    <h2>Content Manager</h2>
        <div class="col-xs-3">
          <h2>Website Pages</h2>
          <div class="boxshadow">
            <ul class="nav nav-pills nav-stacked">
              <repeat group="{{ @pages }}" key="{{ @name }}" value="{{ @page }}">
                <li><a href="{{@BASE}}/admin/pages/{{@name}}">
                  <span class="glyphicon glyphicon-list-alt"></span> {{ @name }}
                  <check if="{{@page.subpages}}">
                    ({{@page.subpages}})
                  </check>
                </a></li>
              </repeat>
            </ul>
          </div>
        </div>


        <div class="col-xs-9">
         
        <h2>Quick View</h2>
        
        <repeat group="{{ @pages }}" key="{{ @name }}" value="{{ @page }}">
        <div class="page">
        
        <div class="row">
         <div class="col-xs-12">
            <check if="{{@name == 'all'}}">
            <true>
               <h3><span class="glyphicon glyphicon-file"></span> Display on all pages <span class="glyphicon glyphicon-plus pull-right"></span></h3>
            </true>
            <false>
               <h3><span class="glyphicon glyphicon-file"></span> <a target="_blank" href="{{@SCHEME}}://{{@HOST}}{{@BASE}}/{{@name}}">{{@name}}</a> <span class="glyphicon glyphicon-plus pull-right"></span></h3>
            </false>
            </check>
         </div>
        </div>
  

        <div class="collapsable">
            <table class="table table-condensed">
              <tr>
                <th width="20%">Content Name</th>
                <th width="30%">Toolbar type</th>
                <th style="text-align: right;" width="40%">Tools</th>
              </tr>

              <repeat group="{{@page}}" value="{{@content_block}}">
              <tr>
                  <td>{{@content_block.contentName}}</td>
                  <td>{{@content_block.type}}</td>
                  <td align="right">
                    <check if="{{@name != 'all'}}"><a href="{{@SCHEME}}://{{@HOST}}{{@BASE}}/{{@name}}" target="_blank"><button><span class="glyphicon glyphicon-pencil"></span> Live Edit</button></a></check>
                    <a href="{{@BASE}}/admin/page/html_edit/{{@content_block.id}}"><button><span class="glyphicon glyphicon-list-alt"></span> HTML Edit</button></a>
                    <check if="{{@webmaster}}">
                    <a href="{{@BASE}}/admin/page/delete_content/{{@content_block.id}}"><button><span class="glyphicon glyphicon-remove-sign"></span> Delete</button></a>
                    </check>
                  </td>
              </tr>
              </repeat>
            </table>
            

            <check if="{{@webmaster}}">
            <form class="well" method="post" action="{{@BASE}}/admin/page/add_content">
             <div class="row">
                <div class="col-xs-3">
                   <div class="input-group">
                     <input name="content_name" type="text" class="form-control" placeholder="Content Name">
                   </div>
                </div>
                <div class="col-xs-3">
                   <div class="input-group">
                      <select name="type" class="selectpicker">
                        <option value="null">Full toobar</option>
                        <option value="header">Header toolbar</option>
                        <option value="img">Image toolbar</option>
                      </select>
                   </div>
                </div>
                <div class="col-xs-3">
                   <div class="input-group">
                     <input name="dummy_content" value="Content Here" type="text" class="form-control">
                   </div>
                </div>
                <div class="col-xs-3">
                   <div class="input-group">
                    <button class="addcontent" type="submit"><span class="glyphicon glyphicon-plus-sign"></span> Add Content Block</button>
                   </div>
                </div>
             </div><!-- /.row -->
              <input type="hidden" name="page" value="{{@name}}">
             </form>
             </check>
         </div>

         </div>
        </repeat>
        </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="{{@BASE}}/admin/bootstrap.min.js"></script>
    <script>
      $(function() {
          $(".glyphicon-plus").click(function () {
            $(this).parent().parent().parent().parent().find(".collapsable").toggle();
          });
      });
    </script>
  </body>
</html>