<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<title>Web Works CMS</title>
	
		<link href="{{ @CDN }}/bootstrap/bootstrap.min.css" rel="stylesheet">
		<link href="{{ @CDN }}/admin/css/jqueryUI.min.css" rel="stylesheet">
		<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
		<link href="{{ @CDN }}/admin/css/main.css" rel="stylesheet">
		
		<style>
			table {
			    border-spacing: collapse;
			    border-spacing: 0;
			}
			tr {
				width: 100%;
			}

			.handle {
				width: 30px;

			}

			.handle i {
				font-weight: none;
			}

			.ui-sortable-handle {
				opacity: 0.2;
				padding-right:3px;

			}

			.ui-sortable-handle:hover {
				opacity: 1;
				cursor: move;
			}
		</style>

		<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
		<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		<!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
			<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->
	</head>
	<body>
		<h1><img src="{{ @CDN }}/admin/imgs/logo.png" alt="Web Works CMS Login"></h1>

		<div class="nav top_nav">
			<include href="/admin/navigation.html" />
		</div>
	
		<div class="container">
			<include href="admin/toolbar.html">
			
			<div class="row">

				<include href="{{'/repeat/'.@snippet}}">

			</div>

		</div>
		
		<include href="admin/_needhelp.html">

		<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
		<script src="{{ @CDN }}/jquery/jquery-3.2.1.min.js"></script>
		<script src="{{ @CDN }}/admin/js/jqueryUI.min.js"></script>
		<!-- Include all compiled plugins (below), or include individual files as needed -->
		<script src="{{ @CDN }}/bootstrap/bootstrap.min.js"></script>

		<script>
			$('.sortable').sortable({
				handle: '.handle', 
				axis: 'y',
			    helper: fixWidthHelper,
				stop: function (event, ui) {
					
					var parent = $(ui.item).parent(); 
					
					var order = [];
					parent.children("tr").each(function () {
						if ($(this).attr("data-id"))
						 	order.push($(this).attr("data-id"));
					});

					$.ajax({
						method: "POST",
						url: "{{@BASE}}/admin/{{@namespace}}/reorder",
						data: { "order": JSON.stringify(order) }
					});
				}
			}).disableSelection();
			    
			function fixWidthHelper(e, ui) {
			    ui.children().each(function() {
			        $(this).width($(this).width());
			    });
			    return ui;
			}
		</script>
	</body>
</html>