<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Web Works CMS</title>

    <!-- Bootstrap -->
    <link href="{{ @BASE }}/css/bootstrap.min.css" rel="stylesheet">
    <link href="{{ @BASE }}/admin/theme" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

<style type="text/css" media="screen">
    .container, .col-xs-12 {
      padding: 0;
    }

    .row {
      margin: 0;
    }

    #editor { 
      height: 600px;
      margin: 0;
    }

    .toolbar button {
      padding: 5px 30px;
      margin: 5px 10px;
      font-weight: bold;
    }

    .toolbar .rightcol {
      text-align: right;
    }
</style>
  </head>
  <body>
    <h1>Web Works CMS</h1>

    <div class="nav">
      <include href="navigation.html" />
    </div>
    
    <div class="container">
      <div class="row">
        <div class="col-xs-12">
          
          <div id="editor">
            {{@block.content}}
          </div>

        </div>
      </div>

      <div class="row toolbar">
        <div class="col-xs-6">
          <a href="{{@BASE}}/admin/pages"><button>Back</button></a>
        </div>
        <div class="col-xs-6 rightcol">
          <button id="save">Save</button>
        </div>
      </div>
    </div>



    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="{{ @BASE }}/admin/bootstrap.min.js"></script>
    <script src="{{ @ACE }}" type="text/javascript" charset="utf-8"></script>

    <script>
        var editor = ace.edit("editor");
        editor.setTheme("ace/theme/ambiance");
        editor.getSession().setMode("ace/mode/html");
        editor.setOptions({
            showGutter: true,
            vScrollBarAlwaysVisible: true,
            printMargin: false,
            fontSize: 16,
        });

        $( document ).ready(function() {
            
            $("#save").click(function () {
              $.ajax({
                  url: "{{@BASE}}/admin/page/htmlsave",
                  method: "POST",
                  data: { id: {{@block.id}}, contents: ace.edit("editor").getValue() },
              }).done(function (response) {
                  alert("Content Saved");
              });
              
              return false;
            });

        });
    </script>
  </body>
</html>